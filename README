screen-session - GNU Screen session saver
=========================================

Website: http://adb.cba.pl

Repository: http://github.com/skoneka/screen-session

Howto: http://adb.cba.pl/gnu-screen-tips-page-my.html#howto-screen-session

-----------------------------------------------------------------------
Description
-----------------------------------------------------------------------
screen-session is a collection of tools for GNU Screen, including
session saver.

session saver currently supports saving of:
directories, programs, layouts, scrollbacks, titles and filters
It recognizes groups and regular windows. Currently there is no support 
for serial and telnet window types.

Available screen-session modes:

manage:
    sessions manager (screenie like) but featuring session preview in a
    split window

regions:
    script reassembling the functionality of tmux display-panes

dir:
    start new Screen window in the same working directory

save:
    save Screen sessions to disk

load:
    load sessions from disk

ls:
    list saved sessions


-----------------------------------------------------------------------
Requirements
-----------------------------------------------------------------------
Requires a recent version of Screen patched with screen-session.diff
Depends on "lsof", "tar", "grep" and reads /proc filesystem.


screen-session.diff changes:
- add "tty" command
- add "regionsize" command
- make "group" queryable


-----------------------------------------------------------------------
Installation
-----------------------------------------------------------------------
Edit config.mk to match your local setup (screen-session is installed 
into the /usr/local namespace by default), you can also disable colors 
by removing "-DCOLOR".


Afterwards enter the following command to build and install 
screen-session (if necessary as root):

    make clean install


Make sure you have a recent version of Screen and apply necessary patch:

    git clone git://git.sv.gnu.org/screen.git screen; cd screen
    
    git-apply ../screen-session-${VERSION}/screen-session.diff

    cd src; autoreconf; autoheader; ./configure && make

    sudo make install


Make sure you have "lsof" installed.


-----------------------------------------------------------------------
Running screen-session
-----------------------------------------------------------------------
see HOWTO

-----------------------------------------------------------------------
Detailed Description
-----------------------------------------------------------------------
session saver saves directories and programs by directly reading /proc 
filesystem  ( it reads cwd, exe and cmdline ) and sorts them by parent
pid. There is no "stuffing" and there is totally no interaction with 
programs in windows.

After session loading, in every new window starts screen-session-primer 
(small C program) which displays a list of processes and asks user what 
to do (whether to start none, part of or all window's processes).
Then, primer tries to restore the string of processes by execing 
for nodes:
$ shell -c "program args; shell" 
and for leafs:
$ program args 

Entire string of processes can only be only properly restored if every 
non-leaf is a shell which accepts '-c command' switch.

Can be restored completly:
0 zsh -> 1 bash -> 2 vim hello.c 

Only up to 1:
0 zsh -> 1 man hello -> 2 less


There is also a blacklist for programs which may not be started
(file $HOME/.screen-sessions/BLACKLIST).
 
screen-session-primer uses linux color escapes. If you dont want color
remove "-DCOLOR" from config.mk

Normally screen-session does not restore exact window numbers. If you 
want to force verbatim restoring use --exact flag.

Savefiles are .tar.bz2 archives (scrollbacks can take a *lot* of space). 
During reading temporary files are stored in  /tmp/screen-session-$USER.


-----------------------------------------------------------------------
Bugs
-----------------------------------------------------------------------
There are no bugs, only features.

- Do not try to save/load a completly detached session with enabled 
  layouts in screen-session because Screen will crash.
  Disable layouts saving/loading with --no-layout flag.

Send suggestions to admin<[at]>adb.cba.pl or github issue tracker
http://github.com/skoneka/screen-session/issues

